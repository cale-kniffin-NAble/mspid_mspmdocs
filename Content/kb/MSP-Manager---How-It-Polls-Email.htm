<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title></title>
    </head>
    <body>
        <h1><MadCap:variable name="General.ProductName_mspm_short" /> - How It Polls Email</h1> <div id="flex"><div id="modified"> <h2>Last Modified</h2><p>Wed Mar 21 12:20 GMT 2018</p></div> <div id="description"> <h2>Description</h2><ul><li>This article details how <MadCap:variable name="General.ProductName_mspm_short" /> uses IMAP to poll for email</li></ul></div> <div id="environment"> <h2>Environment</h2><ul><li><MadCap:variable name="General.ProductName_mspm" /></li></ul></div> <div id="solution"> <h2>Solution</h2><ul><li><span style="font-family: arial, helvetica, sans-serif;"><MadCap:variable name="General.ProductName_mspm_short" /> has a worker role called the IMAPWorker that runs inside of Azure</span><br /> </li><li><span style="font-family: arial, helvetica, sans-serif;">For each ticket mailbox, the IMAP Worker spins up a new thread which connects to the mailbox using IMAP protocol</span><br /> </li><li><span style="font-family: arial, helvetica, sans-serif;">Each connection is always on using IMAP IDLE protocol</span><br /> </li><li><span style="font-family: arial, helvetica, sans-serif;">The connect is on, but idle. When a new email comes into the inbox, it wakes up for processing instantaneously</span><br /> </li><li><span style="font-family: arial, helvetica, sans-serif;">Sometimes the customer's mail server terminates the connection after a period of inactivity, in which case the thread is disposed</span><br /> </li><li><span style="font-family: arial, helvetica, sans-serif;">Every 60 seconds, the IMAP Worker looks for mailboxes that need to be re-connected, new mailboxes that need to get connected, or deleted mailboxes that need to be disconnected</span></li></ul></div> <div id="internal"> <div MadCap:conditions="Default.Ignore"><p><b>Article Number:</b> 112166</p><p><b>Internal notes:</b> Page tags:, stage:published, article:information, visibility:public, imap, msp manager, <MadCap:variable name="General.ProductName_mspm_short" /> email</p><p /></div></div> </div> </body>
</html>